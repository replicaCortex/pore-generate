#set document(
  title: "Метод генерации статистически достоверных синтетических изображений пористых материалов для обучения нейросетевых моделей сегментации",
)
#set heading(numbering: "1.")
#set text(lang: "ru", size: 14pt)
#set par(justify: true)

= Введение

Нейронные сети все чаще применяют для семантической сегментации микроструктуры пористых материалов. Однако их эффективность напрямую зависит от объема и качества обучающих данных. Собрать большой размеченный датасет сложно и дорого из-за высокой стоимости экспериментов, трудоемкости ручной разметки изображений и ограниченного доступа к специализированному оборудованию.

Проблему нехватки данных часто решают с помощью генеративных нейросетей. Но для научного анализа нужны не просто правдоподобные изображения, а статистически достоверные структуры. Генеративные модели не позволяют контролировать ключевые морфологические параметры: пористость, а также распределение пор по размерам и в пространстве.

Цель этой работы — разработать метод, который генерирует статистически достоверные синтетические изображения пористых материалов с помощью алгоритмов Монте-Карло. Метод должен строго контролировать заданные морфологические параметры, чтобы полученные изображения можно было использовать для обучения нейросетевых моделей сегментации.

= Описание алгоритма

Наш алгоритм процедурно генерирует синтетические изображения пористых материалов, используя методы Монте-Карло. Процесс состоит из нескольких этапов.

+ Генерация формы пор. Сначала алгоритм стохастически создает неидеальные формы пор в виде неправильных многоугольников. При этом контролируются параметры неровности и остроты краев. Радиус каждой поры выбирается из распределения Пуассона с заданным математическим ожиданием для имитации реалистичного распределения размеров. Затем к базовым формам применяются морфологические трансформации: растяжение по одной из осей и поворот на произвольный угол.
+ Размещение пор. Далее алгоритм Монте-Карло размещает сгенерированные поры на холсте. Он выполняет множественные попытки найти подходящую позицию, контролируя коллизии и соблюдая минимальные расстояния между порами. Если разместить пору не удается, ее радиус адаптивно уменьшается.
+ На полученное бинарное изображение накладывается многослойный процедурный шум, после чего для каждой поры автоматически вычисляются такие геометрические параметры, как радиус, площадь, эксцентриситет и коэффициент округлости.

Главное преимущество алгоритма — он детерминированно контролирует морфологические параметры, сохраняя при этом стохастическую природу генерации. Это позволяет создавать статистически достоверные синтетические структуры с точно заданными характеристиками.

= Формат описания параметров (JSON)

Для управления генерацией и хранения результатов мы используем два типа JSON-файлов: конфигурационный файл и файл с метаданными. Конфигурационный файл описывает морфологические характеристики для генерации. В нем задаются размерные категории пор, типы морфологии, настройки деформации, параметры процедурного шума и размеры изображений. Файл с метаданными содержит детальную информацию о каждой сгенерированной поре: ее пространственные координаты, геометрические свойства и классификационные метки.

Пример фрагмента JSON-файла с метаданными для одной поры:

```json
{
  "sample_001_clean.png": [
    {
      "center_x": 69, "center_y": 61,
      "original": {
        "radius": 28.0, "area": 2463.01,
        "eccentricity": 0.0, "circularity": 1.0
      },
      "deformed": {
        "radius": 27.27, "area": 2335.5,
        "eccentricity": 0.2469, "circularity": 0.7408
      },
      "size_category": "large_pores",
      "type_category": "single"
    }
  ]
}
```

= Заключение

Мы разработали метод генерации статистически достоверных синтетических изображений пористых материалов на основе алгоритмов Монте-Карло. Он позволяет создавать обучающие выборки с точно заданными морфологическими параметрами, решая проблему дефицита данных для обучения нейросетей. В дальнейшем мы планируем усовершенствовать алгоритм сбора статистики с учетом эффекта обрезки пор на границах изображения. Это повысит точность соответствия между метаданными и финальными изображениями, что необходимо для корректной валидации моделей сегментации.
